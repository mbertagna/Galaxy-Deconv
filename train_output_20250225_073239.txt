INFO:Train: Start training Gaussian_PnP_ADMM_2iters_MultiEllipse on /home/michaelbertagna/git/Galaxy-Deconv/simulated_datasets/LSST_23.5_deconv data for 10 epochs.
INFO:Dataset: Successfully constructed train dataset. Total Samples: 40000.
/home/michaelbertagna/git/Galaxy-Deconv/Galaxy-Deconv.env/lib/python3.11/site-packages/torch/functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3595.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
INFO:Train: [1: 25/1125]  train_loss=17.29  val_loss=1.879e+04
INFO:Train: [1: 50/1125]  train_loss=10.56  val_loss=247.3
INFO:Train: [1: 75/1125]  train_loss=13.41  val_loss=80.05
INFO:Train: [1: 100/1125]  train_loss=21.97  val_loss=85.14
INFO:Train: [1: 125/1125]  train_loss=30  val_loss=177.3
INFO:Train: [1: 150/1125]  train_loss=34.45  val_loss=1184
INFO:Train: [1: 175/1125]  train_loss=51.34  val_loss=91.2
INFO:Train: [1: 200/1125]  train_loss=95.98  val_loss=1096
INFO:Train: [1: 225/1125]  train_loss=111.5  val_loss=3214
INFO:Train: [1: 250/1125]  train_loss=20.68  val_loss=1372
INFO:Train: [1: 275/1125]  train_loss=29.84  val_loss=5831
INFO:Train: [1: 300/1125]  train_loss=11.93  val_loss=12.73
INFO:Train: [1: 325/1125]  train_loss=5.614  val_loss=12.26
INFO:Train: [1: 350/1125]  train_loss=15.08  val_loss=12.23
INFO:Train: [1: 375/1125]  train_loss=3.299  val_loss=12.23
INFO:Train: [1: 400/1125]  train_loss=4.903  val_loss=12.23
INFO:Train: [1: 425/1125]  train_loss=15.73  val_loss=12.24
INFO:Train: [1: 450/1125]  train_loss=8.161  val_loss=12.27
INFO:Train: [1: 475/1125]  train_loss=9.135  val_loss=12.26
INFO:Train: [1: 500/1125]  train_loss=9.497  val_loss=12.26
INFO:Train: [1: 525/1125]  train_loss=12.12  val_loss=12.26
INFO:Train: [1: 550/1125]  train_loss=6.229  val_loss=12.26
INFO:Train: [1: 575/1125]  train_loss=3.928  val_loss=12.26
INFO:Train: [1: 600/1125]  train_loss=8.888  val_loss=12.26
INFO:Train: [1: 625/1125]  train_loss=5.771  val_loss=12.26
INFO:Train: [1: 650/1125]  train_loss=11.55  val_loss=12.26
INFO:Train: [1: 675/1125]  train_loss=6.612  val_loss=12.26
INFO:Train: [1: 700/1125]  train_loss=16.04  val_loss=12.26
INFO:Train: [1: 725/1125]  train_loss=9.059  val_loss=12.26
INFO:Train: [1: 750/1125]  train_loss=10.17  val_loss=12.26
INFO:Train: [1: 775/1125]  train_loss=10.22  val_loss=12.26
INFO:Train: [1: 800/1125]  train_loss=2.867  val_loss=12.26
INFO:Train: [1: 825/1125]  train_loss=14.13  val_loss=12.26
INFO:Train: [1: 850/1125]  train_loss=7.202  val_loss=12.26
INFO:Train: [1: 875/1125]  train_loss=22.69  val_loss=12.26
INFO:Train: [1: 900/1125]  train_loss=6.41  val_loss=12.26
INFO:Train: [1: 925/1125]  train_loss=15.06  val_loss=12.26
INFO:Train: [1: 950/1125]  train_loss=6.145  val_loss=12.26
INFO:Train: [1: 975/1125]  train_loss=7.466  val_loss=12.26
INFO:Train: [1: 1000/1125]  train_loss=5.497  val_loss=12.26
INFO:Train: [1: 1025/1125]  train_loss=19.96  val_loss=12.26
INFO:Train: [1: 1050/1125]  train_loss=12.14  val_loss=12.26
INFO:Train: [1: 1075/1125]  train_loss=6.722  val_loss=12.26
INFO:Train: [1: 1100/1125]  train_loss=4.72  val_loss=12.26
INFO:Train: [1: 1125/1125]  train_loss=3.106  val_loss=12.26
INFO:Train: [1: 1125/1125]  train_loss=6.51e+04  val_loss=12.26
INFO:Train: Model saved to ./saved_models_ellipse_loss/Gaussian_PnP_ADMM_2iters_MultiEllipse_1epochs.pth
INFO:Train: [2: 25/1125]  train_loss=6.227  val_loss=12.26
INFO:Train: [2: 50/1125]  train_loss=12.42  val_loss=12.24
INFO:Train: [2: 75/1125]  train_loss=31.26  val_loss=12.24
INFO:Train: [2: 100/1125]  train_loss=9.576  val_loss=12.23
INFO:Train: [2: 125/1125]  train_loss=9.201  val_loss=12.29
INFO:Train: [2: 150/1125]  train_loss=7.792  val_loss=12.15
INFO:Train: [2: 175/1125]  train_loss=6.895  val_loss=12.04
INFO:Train: [2: 200/1125]  train_loss=8.715  val_loss=11.79
INFO:Train: [2: 225/1125]  train_loss=25.12  val_loss=11.75
INFO:Train: [2: 250/1125]  train_loss=4.51  val_loss=11.74
INFO:Train: [2: 275/1125]  train_loss=13.7  val_loss=11.74
INFO:Train: [2: 300/1125]  train_loss=5.926  val_loss=11.73
INFO:Train: [2: 325/1125]  train_loss=8.967  val_loss=11.73
INFO:Train: [2: 350/1125]  train_loss=9.069  val_loss=11.72
INFO:Train: [2: 375/1125]  train_loss=5.735  val_loss=11.72
INFO:Train: [2: 400/1125]  train_loss=9.748  val_loss=11.71
INFO:Train: [2: 425/1125]  train_loss=17  val_loss=11.71
INFO:Train: [2: 450/1125]  train_loss=6.334  val_loss=11.7
INFO:Train: [2: 475/1125]  train_loss=7.053  val_loss=11.7
INFO:Train: [2: 500/1125]  train_loss=7.183  val_loss=11.7
INFO:Train: [2: 525/1125]  train_loss=6.661  val_loss=11.69
INFO:Train: [2: 550/1125]  train_loss=10.14  val_loss=11.89
INFO:Train: [2: 575/1125]  train_loss=4.334  val_loss=11.98
INFO:Train: [2: 600/1125]  train_loss=10.04  val_loss=11.99
INFO:Train: [2: 625/1125]  train_loss=17.15  val_loss=11.99
INFO:Train: [2: 650/1125]  train_loss=5.431  val_loss=11.99
INFO:Train: [2: 675/1125]  train_loss=7.02  val_loss=11.99
INFO:Train: [2: 700/1125]  train_loss=8.477  val_loss=11.99
INFO:Train: [2: 725/1125]  train_loss=6.631  val_loss=11.99
INFO:Train: [2: 750/1125]  train_loss=6.744  val_loss=11.99
INFO:Train: [2: 775/1125]  train_loss=4.254  val_loss=11.99
INFO:Train: [2: 800/1125]  train_loss=5.161  val_loss=11.99
INFO:Train: [2: 825/1125]  train_loss=16.42  val_loss=11.98
INFO:Train: [2: 850/1125]  train_loss=12.79  val_loss=11.98
INFO:Train: [2: 875/1125]  train_loss=10.89  val_loss=11.98
INFO:Train: [2: 900/1125]  train_loss=6.956  val_loss=11.98
INFO:Train: [2: 925/1125]  train_loss=4.32  val_loss=11.98
INFO:Train: [2: 950/1125]  train_loss=17.37  val_loss=11.98
INFO:Train: [2: 975/1125]  train_loss=14.62  val_loss=11.98
INFO:Train: [2: 1000/1125]  train_loss=29.17  val_loss=11.98
INFO:Train: [2: 1025/1125]  train_loss=8.292  val_loss=11.98
INFO:Train: [2: 1050/1125]  train_loss=18.24  val_loss=11.98
INFO:Train: [2: 1075/1125]  train_loss=8.572  val_loss=11.98
INFO:Train: [2: 1100/1125]  train_loss=7.224  val_loss=11.98
INFO:Train: [2: 1125/1125]  train_loss=7.993  val_loss=11.98
INFO:Train: [2: 1125/1125]  train_loss=5.99e+04  val_loss=11.98
INFO:Train: Model saved to ./saved_models_ellipse_loss/Gaussian_PnP_ADMM_2iters_MultiEllipse_2epochs.pth
INFO:Train: [3: 25/1125]  train_loss=6.19  val_loss=12.03
INFO:Train: [3: 50/1125]  train_loss=4.915  val_loss=11.95
INFO:Train: [3: 75/1125]  train_loss=6.2  val_loss=11.89
INFO:Train: [3: 100/1125]  train_loss=12.33  val_loss=11.83
INFO:Train: [3: 125/1125]  train_loss=7.041  val_loss=11.76
INFO:Train: [3: 150/1125]  train_loss=5.836  val_loss=11.68
INFO:Train: [3: 175/1125]  train_loss=4.56  val_loss=11.57
INFO:Train: [3: 200/1125]  train_loss=4.073  val_loss=11.42
INFO:Train: [3: 225/1125]  train_loss=14.46  val_loss=11.24
INFO:Train: [3: 250/1125]  train_loss=5.586  val_loss=11.01
INFO:Train: [3: 275/1125]  train_loss=4.932  val_loss=10.76
INFO:Train: [3: 300/1125]  train_loss=4.991  val_loss=10.52
INFO:Train: [3: 325/1125]  train_loss=10.43  val_loss=10.31
INFO:Train: [3: 350/1125]  train_loss=10.31  val_loss=10.16
INFO:Train: [3: 375/1125]  train_loss=10.58  val_loss=10.11
INFO:Train: [3: 400/1125]  train_loss=4.09  val_loss=10.07
INFO:Train: [3: 425/1125]  train_loss=3.18  val_loss=10.04
INFO:Train: [3: 450/1125]  train_loss=5.516  val_loss=10.03
INFO:Train: [3: 475/1125]  train_loss=66.57  val_loss=9.989
INFO:Train: [3: 500/1125]  train_loss=2.612  val_loss=9.982
INFO:Train: [3: 525/1125]  train_loss=5.334  val_loss=10.01
INFO:Train: [3: 550/1125]  train_loss=21.97  val_loss=10.05
INFO:Train: [3: 575/1125]  train_loss=3.728  val_loss=10.05
INFO:Train: [3: 600/1125]  train_loss=5.676  val_loss=10.04
INFO:Train: [3: 625/1125]  train_loss=12.39  val_loss=10.04
INFO:Train: [3: 650/1125]  train_loss=9.532  val_loss=10.03
INFO:Train: [3: 675/1125]  train_loss=6.963  val_loss=10.03
INFO:Train: [3: 700/1125]  train_loss=5.458  val_loss=10.02
INFO:Train: [3: 725/1125]  train_loss=5.768  val_loss=10.02
INFO:Train: [3: 750/1125]  train_loss=23.49  val_loss=10.01
INFO:Train: [3: 775/1125]  train_loss=3.966  val_loss=10.01
INFO:Train: [3: 800/1125]  train_loss=12.12  val_loss=10.01
INFO:Train: [3: 825/1125]  train_loss=7.495  val_loss=10.01
INFO:Train: [3: 850/1125]  train_loss=13.03  val_loss=10.01
INFO:Train: [3: 875/1125]  train_loss=4.643  val_loss=10
INFO:Train: [3: 900/1125]  train_loss=12.02  val_loss=10
INFO:Train: [3: 925/1125]  train_loss=197  val_loss=9.995
INFO:Train: [3: 950/1125]  train_loss=8.361  val_loss=9.979
INFO:Train: [3: 975/1125]  train_loss=7.24  val_loss=9.977
INFO:Train: [3: 1000/1125]  train_loss=6.335  val_loss=10.01
INFO:Train: [3: 1025/1125]  train_loss=5.554  val_loss=10.09
INFO:Train: [3: 1050/1125]  train_loss=4.393  val_loss=10.1
INFO:Train: [3: 1075/1125]  train_loss=9.556  val_loss=10.1
INFO:Train: [3: 1100/1125]  train_loss=8.813  val_loss=10.09
INFO:Train: [3: 1125/1125]  train_loss=7.502  val_loss=9.917
INFO:Train: [3: 1125/1125]  train_loss=6.082e+04  val_loss=9.917
INFO:Train: Model saved to ./saved_models_ellipse_loss/Gaussian_PnP_ADMM_2iters_MultiEllipse_3epochs.pth
INFO:Train: [4: 25/1125]  train_loss=186.4  val_loss=9.821
INFO:Train: [4: 50/1125]  train_loss=11.72  val_loss=9.852
INFO:Train: [4: 75/1125]  train_loss=3.808  val_loss=9.853
INFO:Train: [4: 100/1125]  train_loss=1.752  val_loss=9.853
INFO:Train: [4: 125/1125]  train_loss=7.439  val_loss=9.853
INFO:Train: [4: 150/1125]  train_loss=4.532  val_loss=9.855
INFO:Train: [4: 175/1125]  train_loss=5.541  val_loss=9.855
INFO:Train: [4: 200/1125]  train_loss=2.775  val_loss=9.854
INFO:Train: [4: 225/1125]  train_loss=24.85  val_loss=9.855
INFO:Train: [4: 250/1125]  train_loss=8.88  val_loss=9.855
INFO:Train: [4: 275/1125]  train_loss=4.799  val_loss=9.856
INFO:Train: [4: 300/1125]  train_loss=4.474  val_loss=9.857
INFO:Train: [4: 325/1125]  train_loss=12.78  val_loss=9.865
INFO:Train: [4: 350/1125]  train_loss=2.243  val_loss=9.885
INFO:Train: [4: 375/1125]  train_loss=9.489  val_loss=9.869
INFO:Train: [4: 400/1125]  train_loss=6.529  val_loss=9.858
INFO:Train: [4: 425/1125]  train_loss=4.133  val_loss=9.857
INFO:Train: [4: 450/1125]  train_loss=7.702  val_loss=9.849
INFO:Train: [4: 475/1125]  train_loss=12.65  val_loss=9.848
INFO:Train: [4: 500/1125]  train_loss=6.726  val_loss=9.853
INFO:Train: [4: 525/1125]  train_loss=9.617  val_loss=9.847
INFO:Train: [4: 550/1125]  train_loss=11.57  val_loss=9.958
INFO:Train: [4: 575/1125]  train_loss=4.831  val_loss=9.679
INFO:Train: [4: 600/1125]  train_loss=8.022  val_loss=9.697
INFO:Train: [4: 625/1125]  train_loss=3.045  val_loss=9.718
INFO:Train: [4: 650/1125]  train_loss=2.595  val_loss=9.719
INFO:Train: [4: 675/1125]  train_loss=4.449  val_loss=9.718
INFO:Train: [4: 700/1125]  train_loss=3.314  val_loss=9.717
INFO:Train: [4: 725/1125]  train_loss=12.92  val_loss=9.717
INFO:Train: [4: 750/1125]  train_loss=6.055  val_loss=9.716
INFO:Train: [4: 775/1125]  train_loss=9.228  val_loss=9.716
INFO:Train: [4: 800/1125]  train_loss=6.501  val_loss=9.714
INFO:Train: [4: 825/1125]  train_loss=8.143  val_loss=9.715
INFO:Train: [4: 850/1125]  train_loss=6.754  val_loss=9.714
INFO:Train: [4: 875/1125]  train_loss=3.757  val_loss=9.634
INFO:Train: [4: 900/1125]  train_loss=7.314  val_loss=9.688
INFO:Train: [4: 925/1125]  train_loss=16.13  val_loss=9.692
INFO:Train: [4: 950/1125]  train_loss=5.746  val_loss=9.692
INFO:Train: [4: 975/1125]  train_loss=6.864  val_loss=9.691
INFO:Train: [4: 1000/1125]  train_loss=6.728  val_loss=9.69
INFO:Train: [4: 1025/1125]  train_loss=6.839  val_loss=9.689
INFO:Train: [4: 1050/1125]  train_loss=8.536  val_loss=9.688
INFO:Train: [4: 1075/1125]  train_loss=5.571  val_loss=9.688
INFO:Train: [4: 1100/1125]  train_loss=3.28  val_loss=9.687
INFO:Train: [4: 1125/1125]  train_loss=4.757  val_loss=9.686
INFO:Train: [4: 1125/1125]  train_loss=6.037e+04  val_loss=9.686
INFO:Train: Model saved to ./saved_models_ellipse_loss/Gaussian_PnP_ADMM_2iters_MultiEllipse_4epochs.pth
INFO:Train: [5: 25/1125]  train_loss=5.232  val_loss=10.02
INFO:Train: [5: 50/1125]  train_loss=9.045  val_loss=9.995
INFO:Train: [5: 75/1125]  train_loss=5.678  val_loss=9.981
INFO:Train: [5: 100/1125]  train_loss=4.914  val_loss=9.964
INFO:Train: [5: 125/1125]  train_loss=11.72  val_loss=9.951
INFO:Train: [5: 150/1125]  train_loss=7.663  val_loss=9.938
INFO:Train: [5: 175/1125]  train_loss=15.33  val_loss=9.924
INFO:Train: [5: 200/1125]  train_loss=7.432  val_loss=9.908
INFO:Train: [5: 225/1125]  train_loss=6.277  val_loss=9.889
INFO:Train: [5: 250/1125]  train_loss=8.599  val_loss=9.877
INFO:Train: [5: 275/1125]  train_loss=9.142  val_loss=9.874
INFO:Train: [5: 300/1125]  train_loss=4.642  val_loss=9.737
INFO:Train: [5: 325/1125]  train_loss=8.435  val_loss=9.72
INFO:Train: [5: 350/1125]  train_loss=5.269  val_loss=9.712
INFO:Train: [5: 375/1125]  train_loss=13.83  val_loss=9.712
INFO:Train: [5: 400/1125]  train_loss=9.363  val_loss=9.712
INFO:Train: [5: 425/1125]  train_loss=9.746  val_loss=9.711
INFO:Train: [5: 450/1125]  train_loss=7.018  val_loss=9.711
INFO:Train: [5: 475/1125]  train_loss=10.24  val_loss=9.711
INFO:Train: [5: 500/1125]  train_loss=10.98  val_loss=9.711
INFO:Train: [5: 525/1125]  train_loss=7.562  val_loss=9.711
INFO:Train: [5: 550/1125]  train_loss=4.364  val_loss=9.711
INFO:Train: [5: 575/1125]  train_loss=12.37  val_loss=9.711
INFO:Train: [5: 600/1125]  train_loss=4.549  val_loss=9.711
INFO:Train: [5: 625/1125]  train_loss=6.681  val_loss=9.711
INFO:Train: [5: 650/1125]  train_loss=2.99  val_loss=9.711
INFO:Train: [5: 675/1125]  train_loss=6.259  val_loss=9.711
INFO:Train: [5: 700/1125]  train_loss=4.709  val_loss=9.711
INFO:Train: [5: 725/1125]  train_loss=3.354  val_loss=9.711
INFO:Train: [5: 750/1125]  train_loss=7.214  val_loss=9.711
INFO:Train: [5: 775/1125]  train_loss=1.718  val_loss=9.711
INFO:Train: [5: 800/1125]  train_loss=9.83  val_loss=9.711
INFO:Train: [5: 825/1125]  train_loss=7.374  val_loss=9.711
INFO:Train: [5: 850/1125]  train_loss=4.085  val_loss=9.711
INFO:Train: [5: 875/1125]  train_loss=7.194  val_loss=9.711
INFO:Train: [5: 900/1125]  train_loss=7.065  val_loss=9.711
INFO:Train: [5: 925/1125]  train_loss=6.83  val_loss=9.711
INFO:Train: [5: 950/1125]  train_loss=5.264  val_loss=9.711
INFO:Train: [5: 975/1125]  train_loss=4.654  val_loss=9.711
INFO:Train: [5: 1000/1125]  train_loss=4.295  val_loss=9.711
INFO:Train: [5: 1025/1125]  train_loss=4.038  val_loss=9.711
INFO:Train: [5: 1050/1125]  train_loss=10.96  val_loss=9.711
INFO:Train: [5: 1075/1125]  train_loss=6.471  val_loss=9.711
INFO:Train: [5: 1100/1125]  train_loss=5.328  val_loss=9.711
INFO:Train: [5: 1125/1125]  train_loss=7.171  val_loss=9.711
INFO:Train: [5: 1125/1125]  train_loss=6.452e+04  val_loss=9.711
INFO:Train: Model saved to ./saved_models_ellipse_loss/Gaussian_PnP_ADMM_2iters_MultiEllipse_5epochs.pth
INFO:Train: [6: 25/1125]  train_loss=5.458  val_loss=9.664
INFO:Train: [6: 50/1125]  train_loss=3.17  val_loss=9.652
INFO:Train: [6: 75/1125]  train_loss=5.165  val_loss=9.643
INFO:Train: [6: 100/1125]  train_loss=3.305  val_loss=9.638
INFO:Train: [6: 125/1125]  train_loss=8.13  val_loss=9.634
INFO:Train: [6: 150/1125]  train_loss=4.496  val_loss=9.631
INFO:Train: [6: 175/1125]  train_loss=5.316  val_loss=9.63
INFO:Train: [6: 200/1125]  train_loss=2.212  val_loss=9.632
INFO:Train: [6: 225/1125]  train_loss=2.594  val_loss=9.63
INFO:Train: [6: 250/1125]  train_loss=15.61  val_loss=9.629
INFO:Train: [6: 275/1125]  train_loss=8.895  val_loss=9.629
INFO:Train: [6: 300/1125]  train_loss=4.959  val_loss=9.629
INFO:Train: [6: 325/1125]  train_loss=2.828  val_loss=9.629
INFO:Train: [6: 350/1125]  train_loss=7.402  val_loss=9.62
INFO:Train: [6: 375/1125]  train_loss=5.533  val_loss=9.623
INFO:Train: [6: 400/1125]  train_loss=7.471  val_loss=9.624
INFO:Train: [6: 425/1125]  train_loss=6.015  val_loss=9.627
INFO:Train: [6: 450/1125]  train_loss=9.175  val_loss=9.628
INFO:Train: [6: 475/1125]  train_loss=6.108  val_loss=9.628
INFO:Train: [6: 500/1125]  train_loss=9.458  val_loss=9.627
INFO:Train: [6: 525/1125]  train_loss=11.78  val_loss=9.627
INFO:Train: [6: 550/1125]  train_loss=5.643  val_loss=9.627
INFO:Train: [6: 575/1125]  train_loss=13.04  val_loss=9.626
INFO:Train: [6: 600/1125]  train_loss=7.057  val_loss=9.626
INFO:Train: [6: 625/1125]  train_loss=4.753  val_loss=9.626
INFO:Train: [6: 650/1125]  train_loss=6.344  val_loss=9.632
INFO:Train: [6: 675/1125]  train_loss=4.526  val_loss=9.633
INFO:Train: [6: 700/1125]  train_loss=15.58  val_loss=9.632
INFO:Train: [6: 725/1125]  train_loss=5.438  val_loss=9.632
INFO:Train: [6: 750/1125]  train_loss=15.42  val_loss=10.66
INFO:Train: [6: 775/1125]  train_loss=6.093  val_loss=10.74
INFO:Train: [6: 800/1125]  train_loss=7.453  val_loss=10.74
INFO:Train: [6: 825/1125]  train_loss=5.258  val_loss=10.72
INFO:Train: [6: 850/1125]  train_loss=5.748  val_loss=10.71
INFO:Train: [6: 875/1125]  train_loss=76.31  val_loss=10.69
INFO:Train: [6: 900/1125]  train_loss=8.586  val_loss=10.66
INFO:Train: [6: 925/1125]  train_loss=9.419  val_loss=10.64
INFO:Train: [6: 950/1125]  train_loss=18.51  val_loss=10.63
INFO:Train: [6: 975/1125]  train_loss=10.46  val_loss=10.62
INFO:Train: [6: 1000/1125]  train_loss=5.65  val_loss=10.61
INFO:Train: [6: 1025/1125]  train_loss=1.676  val_loss=10.61
INFO:Train: [6: 1050/1125]  train_loss=6.523  val_loss=10.6
INFO:Train: [6: 1075/1125]  train_loss=10.8  val_loss=10.59
INFO:Train: [6: 1100/1125]  train_loss=6.891  val_loss=10.59
INFO:Train: [6: 1125/1125]  train_loss=13.72  val_loss=10.57
INFO:Train: [6: 1125/1125]  train_loss=6.475e+04  val_loss=10.57
INFO:Train: [7: 25/1125]  train_loss=3.43  val_loss=10.67
INFO:Train: [7: 50/1125]  train_loss=6.754  val_loss=10.65
INFO:Train: [7: 75/1125]  train_loss=13.88  val_loss=11.59
INFO:Train: [7: 100/1125]  train_loss=6.654  val_loss=11.45
INFO:Train: [7: 125/1125]  train_loss=2.699  val_loss=11.42
INFO:Train: [7: 150/1125]  train_loss=6.434  val_loss=11.4
INFO:Train: [7: 175/1125]  train_loss=9.699  val_loss=11.39
INFO:Train: [7: 200/1125]  train_loss=9.066  val_loss=11.37
INFO:Train: [7: 225/1125]  train_loss=15.85  val_loss=11.36
INFO:Train: [7: 250/1125]  train_loss=2.372  val_loss=11.35
INFO:Train: [7: 275/1125]  train_loss=2.83  val_loss=11.34
INFO:Train: [7: 300/1125]  train_loss=9.622  val_loss=11.34
INFO:Train: [7: 325/1125]  train_loss=6.017  val_loss=11.34
INFO:Train: [7: 350/1125]  train_loss=7.777  val_loss=11.34
INFO:Train: [7: 375/1125]  train_loss=8.792  val_loss=11.33
INFO:Train: [7: 400/1125]  train_loss=5.462  val_loss=11.33
INFO:Train: [7: 425/1125]  train_loss=8.14  val_loss=11.33
INFO:Train: [7: 450/1125]  train_loss=6.286  val_loss=11.32
INFO:Train: [7: 475/1125]  train_loss=12.03  val_loss=11.32
INFO:Train: [7: 500/1125]  train_loss=8.023  val_loss=11.32
INFO:Train: [7: 525/1125]  train_loss=8.571  val_loss=11.32
INFO:Train: [7: 550/1125]  train_loss=15.35  val_loss=11.31
INFO:Train: [7: 575/1125]  train_loss=6.366  val_loss=11.31
INFO:Train: [7: 600/1125]  train_loss=5.731  val_loss=11.31
INFO:Train: [7: 625/1125]  train_loss=10.71  val_loss=11.31
INFO:Train: [7: 650/1125]  train_loss=8.531  val_loss=11.31
INFO:Train: [7: 675/1125]  train_loss=11.36  val_loss=11.31
INFO:Train: [7: 700/1125]  train_loss=7.149  val_loss=11.31
INFO:Train: [7: 725/1125]  train_loss=3.604  val_loss=11.3
INFO:Train: [7: 750/1125]  train_loss=4.601  val_loss=11.3
INFO:Train: [7: 775/1125]  train_loss=4.363  val_loss=11.3
INFO:Train: [7: 800/1125]  train_loss=7.09  val_loss=11.3
INFO:Train: [7: 825/1125]  train_loss=6.908  val_loss=11.3
INFO:Train: [7: 850/1125]  train_loss=4.149  val_loss=11.3
INFO:Train: [7: 875/1125]  train_loss=80.55  val_loss=11.3
INFO:Train: [7: 900/1125]  train_loss=23.05  val_loss=11.3
INFO:Train: [7: 925/1125]  train_loss=7.746  val_loss=11.29
INFO:Train: [7: 950/1125]  train_loss=5.995  val_loss=11.29
INFO:Train: [7: 975/1125]  train_loss=8.483  val_loss=11.29
INFO:Train: [7: 1000/1125]  train_loss=10.5  val_loss=11.29
INFO:Train: [7: 1025/1125]  train_loss=5.936  val_loss=11.29
INFO:Train: [7: 1050/1125]  train_loss=5.503  val_loss=11.29
INFO:Train: [7: 1075/1125]  train_loss=9.551  val_loss=11.29
INFO:Train: [7: 1100/1125]  train_loss=7.54  val_loss=11.29
INFO:Train: [7: 1125/1125]  train_loss=1.822  val_loss=11.29
INFO:Train: [7: 1125/1125]  train_loss=5.769e+04  val_loss=11.29
INFO:Train: [8: 25/1125]  train_loss=12.76  val_loss=11.43
INFO:Train: [8: 50/1125]  train_loss=6.101  val_loss=11.42
INFO:Train: [8: 75/1125]  train_loss=29.28  val_loss=11.4
INFO:Train: [8: 100/1125]  train_loss=11.62  val_loss=11.4
INFO:Train: [8: 125/1125]  train_loss=7.742  val_loss=11.39
INFO:Train: [8: 150/1125]  train_loss=16.83  val_loss=11.38
INFO:Train: [8: 175/1125]  train_loss=6.754  val_loss=11.38
INFO:Train: [8: 200/1125]  train_loss=7.953  val_loss=11.38
INFO:Train: [8: 225/1125]  train_loss=4.577  val_loss=11.37
INFO:Train: [8: 250/1125]  train_loss=10.75  val_loss=11.37
INFO:Train: [8: 275/1125]  train_loss=10.21  val_loss=11.36
INFO:Train: [8: 300/1125]  train_loss=7.389  val_loss=11.36
INFO:Train: [8: 325/1125]  train_loss=6.904  val_loss=11.34
INFO:Train: [8: 350/1125]  train_loss=6.589  val_loss=11.34
INFO:Train: [8: 375/1125]  train_loss=10.9  val_loss=11.34
INFO:Train: [8: 400/1125]  train_loss=8.163  val_loss=11.34
INFO:Train: [8: 425/1125]  train_loss=13.59  val_loss=11.34
INFO:Train: [8: 450/1125]  train_loss=4.178  val_loss=11.34
INFO:Train: [8: 475/1125]  train_loss=5.964  val_loss=11.34
INFO:Train: [8: 500/1125]  train_loss=10.77  val_loss=11.33
INFO:Train: [8: 525/1125]  train_loss=5.719  val_loss=11.33
INFO:Train: [8: 550/1125]  train_loss=8.479  val_loss=11.33
INFO:Train: [8: 575/1125]  train_loss=44.21  val_loss=11.33
INFO:Train: [8: 600/1125]  train_loss=12.32  val_loss=11.33
INFO:Train: [8: 625/1125]  train_loss=4.971  val_loss=11.33
INFO:Train: [8: 650/1125]  train_loss=6.663  val_loss=11.33
INFO:Train: [8: 675/1125]  train_loss=8.279  val_loss=11.33
INFO:Train: [8: 700/1125]  train_loss=3.254  val_loss=11.33
INFO:Train: [8: 725/1125]  train_loss=6.555  val_loss=11.33
INFO:Train: [8: 750/1125]  train_loss=10.97  val_loss=11.33
INFO:Train: [8: 775/1125]  train_loss=4.185  val_loss=11.33
INFO:Train: [8: 800/1125]  train_loss=13  val_loss=11.33
INFO:Train: [8: 825/1125]  train_loss=6.315  val_loss=12.07
INFO:Train: [8: 850/1125]  train_loss=7.918  val_loss=13.95
INFO:Train: [8: 875/1125]  train_loss=6.81  val_loss=13.74
INFO:Train: [8: 900/1125]  train_loss=8.581  val_loss=13.61
INFO:Train: [8: 925/1125]  train_loss=14.5  val_loss=13.44
INFO:Train: [8: 950/1125]  train_loss=6.982  val_loss=13.42
INFO:Train: [8: 975/1125]  train_loss=7.421  val_loss=13.36
INFO:Train: [8: 1000/1125]  train_loss=9.528  val_loss=13.32
INFO:Train: [8: 1025/1125]  train_loss=19.49  val_loss=13.33
INFO:Train: [8: 1050/1125]  train_loss=3.3  val_loss=13.32
INFO:Train: [8: 1075/1125]  train_loss=9.116  val_loss=13.36
INFO:Train: [8: 1100/1125]  train_loss=5.001  val_loss=13.38
INFO:Train: [8: 1125/1125]  train_loss=8.066  val_loss=13.36
INFO:Train: [8: 1125/1125]  train_loss=4.409e+04  val_loss=13.36
INFO:Train: [9: 25/1125]  train_loss=11.35  val_loss=13.75
INFO:Train: [9: 50/1125]  train_loss=8.634  val_loss=13.74
INFO:Train: [9: 75/1125]  train_loss=6.774  val_loss=10.05
INFO:Train: [9: 100/1125]  train_loss=9.232  val_loss=9.134
INFO:Train: [9: 125/1125]  train_loss=12.07  val_loss=9.085
INFO:Train: [9: 150/1125]  train_loss=4.004  val_loss=9.077
INFO:Train: [9: 175/1125]  train_loss=8.207  val_loss=9.074
INFO:Train: [9: 200/1125]  train_loss=3.639  val_loss=9.072
INFO:Train: [9: 225/1125]  train_loss=2.422  val_loss=9.067
INFO:Train: [9: 250/1125]  train_loss=9.374  val_loss=9.064
INFO:Train: [9: 275/1125]  train_loss=6.986  val_loss=9.062
INFO:Train: [9: 300/1125]  train_loss=10.48  val_loss=9.061
INFO:Train: [9: 325/1125]  train_loss=6.958  val_loss=9.06
INFO:Train: [9: 350/1125]  train_loss=10.56  val_loss=9.058
INFO:Train: [9: 375/1125]  train_loss=11.7  val_loss=9.04
INFO:Train: [9: 400/1125]  train_loss=5.831  val_loss=9.036
INFO:Train: [9: 425/1125]  train_loss=3.802  val_loss=9.034
INFO:Train: [9: 450/1125]  train_loss=7.415  val_loss=9.033
INFO:Train: [9: 475/1125]  train_loss=8.067  val_loss=9.03
INFO:Train: [9: 500/1125]  train_loss=12.63  val_loss=9.025
INFO:Train: [9: 525/1125]  train_loss=5.477  val_loss=9.024
INFO:Train: [9: 550/1125]  train_loss=6.003  val_loss=9.023
INFO:Train: [9: 575/1125]  train_loss=2.436  val_loss=9.022
INFO:Train: [9: 600/1125]  train_loss=11.45  val_loss=9.021
INFO:Train: [9: 625/1125]  train_loss=17.94  val_loss=9.021
INFO:Train: [9: 650/1125]  train_loss=3.984  val_loss=9.021
INFO:Train: [9: 675/1125]  train_loss=6.318  val_loss=9.021
INFO:Train: [9: 700/1125]  train_loss=6.689  val_loss=9.021
INFO:Train: [9: 725/1125]  train_loss=8.913  val_loss=9.02
INFO:Train: [9: 750/1125]  train_loss=6.541  val_loss=9.02
INFO:Train: [9: 775/1125]  train_loss=3.526  val_loss=9.02
INFO:Train: [9: 800/1125]  train_loss=8.348  val_loss=9.02
INFO:Train: [9: 825/1125]  train_loss=7.203  val_loss=9.02
INFO:Train: [9: 850/1125]  train_loss=2.222  val_loss=9.019
INFO:Train: [9: 875/1125]  train_loss=3.58  val_loss=9.019
INFO:Train: [9: 900/1125]  train_loss=9.101  val_loss=9.019
INFO:Train: [9: 925/1125]  train_loss=18.24  val_loss=9.019
INFO:Train: [9: 950/1125]  train_loss=8.835  val_loss=9.019
INFO:Train: [9: 975/1125]  train_loss=9.838  val_loss=9.018
INFO:Train: [9: 1000/1125]  train_loss=4.134  val_loss=9.018
INFO:Train: [9: 1025/1125]  train_loss=9.071  val_loss=9.018
INFO:Train: [9: 1050/1125]  train_loss=5.673  val_loss=9.018
INFO:Train: [9: 1075/1125]  train_loss=8.158  val_loss=9.017
INFO:Train: [9: 1100/1125]  train_loss=5.592  val_loss=9.017
INFO:Train: [9: 1125/1125]  train_loss=7.802  val_loss=9.017
INFO:Train: [9: 1125/1125]  train_loss=9.99e+04  val_loss=9.017
INFO:Train: Model saved to ./saved_models_ellipse_loss/Gaussian_PnP_ADMM_2iters_MultiEllipse_9epochs.pth
INFO:Train: [10: 25/1125]  train_loss=7.991  val_loss=8.925
INFO:Train: [10: 50/1125]  train_loss=4.94  val_loss=8.925
INFO:Train: [10: 75/1125]  train_loss=9.117  val_loss=8.925
INFO:Train: [10: 100/1125]  train_loss=4.932  val_loss=8.925
INFO:Train: [10: 125/1125]  train_loss=14.26  val_loss=8.925
INFO:Train: [10: 150/1125]  train_loss=8.281  val_loss=8.925
INFO:Train: [10: 175/1125]  train_loss=7.28  val_loss=8.924
INFO:Train: [10: 200/1125]  train_loss=5.791  val_loss=8.924
INFO:Train: [10: 225/1125]  train_loss=3.486  val_loss=8.924
INFO:Train: [10: 250/1125]  train_loss=4.07  val_loss=8.924
INFO:Train: [10: 275/1125]  train_loss=2.914  val_loss=8.923
INFO:Train: [10: 300/1125]  train_loss=11.45  val_loss=8.923
INFO:Train: [10: 325/1125]  train_loss=5.733  val_loss=8.923
INFO:Train: [10: 350/1125]  train_loss=11.45  val_loss=8.923
INFO:Train: [10: 375/1125]  train_loss=11.75  val_loss=8.923
INFO:Train: [10: 400/1125]  train_loss=2.782  val_loss=8.923
INFO:Train: [10: 425/1125]  train_loss=6.173  val_loss=8.923
INFO:Train: [10: 450/1125]  train_loss=7.735  val_loss=8.923
INFO:Train: [10: 475/1125]  train_loss=8.604  val_loss=8.923
INFO:Train: [10: 500/1125]  train_loss=1254  val_loss=8.922
INFO:Train: [10: 525/1125]  train_loss=3.155  val_loss=8.92
INFO:Train: [10: 550/1125]  train_loss=9.291  val_loss=8.92
INFO:Train: [10: 575/1125]  train_loss=7.807  val_loss=8.92
INFO:Train: [10: 600/1125]  train_loss=8.289  val_loss=8.919
INFO:Train: [10: 625/1125]  train_loss=3.842  val_loss=8.919
INFO:Train: [10: 650/1125]  train_loss=6.652  val_loss=8.92
INFO:Train: [10: 675/1125]  train_loss=7.073  val_loss=8.92
INFO:Train: [10: 700/1125]  train_loss=6.371  val_loss=8.92
INFO:Train: [10: 725/1125]  train_loss=3.075  val_loss=8.92
INFO:Train: [10: 750/1125]  train_loss=3.91  val_loss=8.919
INFO:Train: [10: 775/1125]  train_loss=3.026  val_loss=8.919
INFO:Train: [10: 800/1125]  train_loss=6.457  val_loss=8.919
INFO:Train: [10: 825/1125]  train_loss=4.031  val_loss=8.919
INFO:Train: [10: 850/1125]  train_loss=20.29  val_loss=8.919
INFO:Train: [10: 875/1125]  train_loss=4.873  val_loss=8.919
INFO:Train: [10: 900/1125]  train_loss=5.905  val_loss=8.919
INFO:Train: [10: 925/1125]  train_loss=10.75  val_loss=8.918
INFO:Train: [10: 950/1125]  train_loss=7.092  val_loss=8.918
INFO:Train: [10: 975/1125]  train_loss=18.31  val_loss=50.09
INFO:Train: [10: 1000/1125]  train_loss=26.65  val_loss=1.66e+04
Traceback (most recent call last):
  File "/home/michaelbertagna/git/Galaxy-Deconv/train.py", line 164, in <module>
    train(model_name=opt.model, n_iters=opt.n_iters, llh=opt.llh, PnP=True, remove_SubNet=opt.remove_SubNet, filter=opt.filter,
  File "/home/michaelbertagna/git/Galaxy-Deconv/train.py", line 84, in train
    loss = loss_fn(gt, rec)
           ^^^^^^^^^^^^^^^^
  File "/home/michaelbertagna/git/Galaxy-Deconv/Galaxy-Deconv.env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michaelbertagna/git/Galaxy-Deconv/Galaxy-Deconv.env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michaelbertagna/git/Galaxy-Deconv/utils/utils_train.py", line 122, in forward
    target_params, _ = ellipse_params_batched(transform_tensor_batched(target), peak_pos=pp)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michaelbertagna/git/Galaxy-Deconv/utils/fit_ellipse.py", line 152, in ellipse_params_batched
    params = weighted_ellipse_fit_batched(points, weights)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/michaelbertagna/git/Galaxy-Deconv/utils/fit_ellipse.py", line 131, in weighted_ellipse_fit_batched
    U, S, V = torch.svd(D_weighted)
              ^^^^^^^^^^^^^^^^^^^^^
torch._C._LinAlgError: linalg.svd: (Batch element 0): The algorithm failed to converge because the input matrix contained non-finite values.

real	310m12.113s
user	3086m44.070s
sys	3m51.637s
